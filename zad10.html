<!DOCTYPE html>
<html>
<body>
    <style>
        body {
        background-color: #373737;
        }
        * {
          box-sizing: border-box;
        }      
        .column {
          float: left;
          width: 33.33%;
          padding: 5px;
        }
        .row::after {
          content: "";
          clear: both;
          display: table;
        }
        .button {
            background-color: #04AA6D;
            border: none;
            color: white;
            padding: 15px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            
        }
         
        .button {border-radius: 12px;}

        .zoom:hover {
            -ms-transform: scale(0.5); 
            -webkit-transform: scale(0.5); 
            transform: scale(1.05); 
        }  

        #myProgress {
            width: 50%;
            background-color: #ddd;
            margin: auto;
        }

        #myBar {
            width: 0%;
            height: 30px;
        background-color: #4CAF50;
        }
    </style>
<h1 style="text-align:center; color:white" >Zaznacz obrazki</h1>
<br>
<div class="row">
    <div class="column">
      <img class="zoom" id="1" src="Images/0.jpg" alt="Bee" style="width:80%" onclick="mySelect(id);">
    </div>
    <div class="column">
      <img class="zoom" id="2" src="Images/1.jpg" alt="Bear" style="width:80%" onclick="mySelect(id)">
    </div>
    <div class="column">
      <img class="zoom" id="3" src="Images/2.jpg" alt="Dog" style="width:80%" onclick="mySelect(id)">
    </div>
</div>
<br>
<div style="text-align: center;">
    <audio id="video" controls preload='auto'>
        <source src="Audio/Large Black Bear Single Roar - QuickSounds.com.mp3" type="audio/mp3">
    </audio>
</div>
<div style="text-align: center;">
    <button class="button" id="myBtn" onclick="checkAnswers(); drawImgages(); drawSound();disableButton(this)">Zgłoś odpowiedzi</button>
    <!-- <button class="button" onclick="reset()">Resetuj ćwiczenie</button> -->
</div>
<div style="text-align: center;">
    <h3 style="color:white" >Poprawne odpowiedzi:  <span id="myText"></span></h3>
</div>
<div style="text-align: center;" id="myProgress">
    <div id="myBar"></div>
</div>
<br>

<script>
    var timesClicked = correctAnswers = 0;
    var answers = ["1"];
    var block = false;
    var checked = [];
    var imgs = ['Images/0.jpg', 'Images/1.jpg', 'Images/2.jpg','Images/3.jpg'];
    var alt= ['Bee','Bear','Dog','Parrot','Fish'];
    var audioTracks = ['Audio/Bee-noise.mp3','Audio/Large Black Bear Single Roar - QuickSounds.com.mp3','Audio/Dog-barking-multiple-sound-effect.mp3'];
    var checkedalt = [];
    var altans = [alt[answers[0]]];
    var iterator = 0;
    var draw = false;
    console.log(altans);


    var increment = 0;
    var i = 0;
    function move() {
        if(increment < 100){
            increment += 25;
            var elem = document.getElementById("myBar");
            var width = elem.style.width = increment + "%";
            var id = setInterval(frame,10);
            function frame(){
                if(increment>= 100){
                 clearInterval(id);           
                }
            }
        }
    }


    //chcecking and unchecking images and adding answers to array or deleting them if are unchecked
    function mySelect(id){
        if(block == false){
            timesClicked++;
            if(timesClicked%2==0){
                document.getElementById(id).style.border = "none";
                let a = document.getElementById(id).alt;
                checked.remove(id);
                checkedalt.remove(a);
                console.log(checkedalt);
            
            }else{
                document.getElementById(id).style.border = "7px solid blue";
                let a = document.getElementById(id).alt;
                checkedalt.push(a);
                checked.push(id);
                console.log(checkedalt);
            }
        }
    } 

    function checkAnswers(){
        iterator ++;
        //sort array so the sequence of choosing correct answers won't affect the outcome, the only thing that matters is to choose correct answers
        altans.sort();
        checkedalt.sort();
        if(checked.length == 0){
            alert("nie wybrałeś żadnej odpowiedzi!");
            draw = false;
        }else{              
            if(JSON.stringify(altans)==JSON.stringify(checkedalt)){
            //marking correct answers in green after check
            console.log("block "+ block);
            if(iterator == 10){
                block = true;
            }     
            for(let i = 0; i<checked.length;i++){
                var goodAnswers = checked[i];
                move();
                //document.getElementById(goodAnswers).style.border = "7px solid green";
                draw = true;
            } 
            correctAnswers ++;
            document.getElementById("myText").innerHTML = correctAnswers;
            }else{
                //marking wrong answers in red after check
                for(let i = 0; i<checked.length;i++){
                    var wrongAnswers = checked[i];
                    document.getElementById(wrongAnswers).style.border = "7px solid red";                    
                }
                          
                document.getElementById("myText").innerHTML = correctAnswers;
                draw = false;
            }
        }
        checkedalt = [];

    }

    //function that allows us to remove item from array checked by passed value 
    Array.prototype.remove = function() {
    var what, a = arguments, L = a.length, ax;
    while (L && this.length) {
        what = a[--L];
            while ((ax = this.indexOf(what)) !== -1) {
                this.splice(ax, 1);
            }
        }
        return this;
    };

    //after sthe test is over blocks button 
    function disableButton(btn){
        if(block == true){
            document.getElementById(btn.id).disabled = true;
        }		
	}

    function drawImgages(){
        console.log(false);
        if(draw != false){
            for( let j =0; j<checked.length;j++){
                document.getElementById(checked[j]).style.border = "none";
                checked = [];
            }
            //var temp = [];
            //console.log(getRandomQuizPieces(3));
            var temp = getRandomQuizPieces(3);
            console.log(temp);
            for(let i = 1; i <=temp.length;i++){              
                document.getElementById(i).src = imgs[temp[i-1]];  
                document.getElementById(i).alt = alt[temp[i- 1]]; 
                //document.getElementById("video").src = audioTracks[i];
                
            }
        }    
    }
    //returns array of random nad not repeating images
    function getRandomQuizPieces(qt){
        let indexSet = new Set();
        while(indexSet.size != qt){
            indexSet.add(getRandomIntInclusive(0, imgs.length-1));
        }
        return Array.from(indexSet);
    }

    function drawSound(){  
        if(draw != false){
            var track = getRandomIntInclusive(0,2);
            document.getElementById("video").src = audioTracks[track];

            switch(track){
                case 0: 
                    altans = [alt[track]];
                break;
                case 1: 
                    altans = [alt[track]];
                break;
                case 2: 
                    altans = [alt[track]];
                break;
            }
        }      

    }
    
    // draws randomly a number between two values including them also
    function getRandomIntInclusive(min, max) {
        min = Math.ceil(min);
        max = Math.floor(max);
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

</script>
</body>
</html>